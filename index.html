<html>
  <head>
    <script src="./output/app.js"></script>
    <style>
      textarea {
        font-family: Courier New;
        font-size: 12pt;
      }
    </style>
  </head>
  <body>
    <h3>Input</h3>
    <label>Type System:</label>
    <select id="picker">
      <option value="untyped">Untyped Lambda Calculus</option>
      <option value="stlc">Simply Typed Lambda Calculus</option>
      <option value="systemt">System T</option>
    </select>
    <p></p>
    <textarea id="input" cols=80 rows=32>
-- Write your program here

1</textarea>
    <h3>Output</h3>
    <textarea id="output" cols=80 rows=5></textarea>
    <script>
      let type_system = "untyped";

      let runFuncs = {
        "untyped": "runUntyped",
        "stlc": "runSimple",
        "systemt": "runSystemT"
      };

      let run = PS["Main"].run;

      let input_box = document.querySelector("#input");
      let output_box = document.querySelector("#output");
      let evaluate = function() {
        output_box.value = PS["Main"][runFuncs[type_system]](input_box.value);
      };
      input_box.addEventListener("input", evaluate);

      let picker = document.querySelector("#picker");
      picker.addEventListener("change", function(event) {
        type_system = event.target.value;
        evaluate();
      });

      evaluate();
    </script>

    <p>Untyped Lambda Calculus Prelude</p>
    <pre>
id = \x. x

-- Booleans
true = \x. \y. x
false = \x. \y. y

-- Pairs
MkPair = \a. \b. \x. x a b
fst = \p. p true
snd = \p. p false

-- Natural numbers
zero = \f. \x. x
succ = \n. \f. \x. f (n f x)

-- (for convenience, you can use integer literals)
three = 3

-- predecessor of a natural number (pred 4 == 3)
pred = \n. fst (predHelper n)
predHelper = \n. n (\p. \x. x (snd p) (succ (snd p))) (MkPair 0 0)

isZero = \n. n (\t. false) true

plus = \n. \m. \f. \x. n f (m f x)
minus = \n. \m. m pred n
mult = \n. \m. n (plus m) 0
exp = \n. \m. m (mult n) 1
    </pre>
    <p>Simply Typed Lambda Calculus Prelude</p>
    <pre>
-- Natural numbers
succ = \n : (N -> N) -> N -> N. \f : N -> N. \x : N. f (n f x)
plus = \n : (N -> N) -> N -> N. \m : (N -> N) -> N -> N. \f : N -> N. \x : N. n f (m f x)
mult = \n : (N -> N) -> N -> N. \m : (N -> N) -> N -> N. \f : N -> N. \x : N. n (m f) x
    </pre>
    <p>System T Prelude</p>
    <pre>
-- Natural numbers:
-- Succ and Zero are built in
-- As is Rec, the generic recursion combinator

plus = \m : Nat. \n : Nat. Rec (\x : Nat. \k : Nat. Succ k) m n
mult = \m : Nat. \n : Nat. Rec (\x : Nat. \k : Nat. plus k m) 0 n
    </pre>
  </body>
</html>
